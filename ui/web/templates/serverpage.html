{{ define "server"}}
    {{ template "header" .}}

    <script> $(document).ready(function () {
            $("#addserver").click(function () {
                let form = $("#addserver_form").serializeArray();
                let data = new Map();
                $(form).each(function (index, obj) {
                    data.set(obj.name, obj.value);
                });
                $.ajax({
                    'url': '/api/server',
                    'method': 'POST',
                    'dataType': 'json',
                    'contentType': 'application/json',
                    'data': JSON.stringify({
                        "port": data.get('port')
                    }),
                    statusCode: {
                        400: function () {
                            alert("неправельные данные");
                        },
                        302: function () {
                            window.location.href = "/api/login";
                        }
                    },
                    success: function (data) {
                        window.location.href = "/api/serverpage";
                    },
                });
            });

            $(".delete-button").click(function () {
                var id = $(this).prop("name");
                alert(id)
                $.ajax({
                    'url': '/api/server/' + id,
                    'method': 'DELETE',
                    'contentType': 'application/json',
                    statusCode: {
                        400: function () {
                            alert("неправельные данные");
                        },
                        302: function () {
                            window.location.href = "/api/login";
                        }
                    },
                    success: function (data) {
                        window.location.href = "/api/serverpage";
                    },
                });
            });
        });
    </script>
    <script src="/static/bootstrap/js/bootstrap.min.js"></script>

    <div class="container" style="margin-top:50px;">
        <div class="row">
            <div class="col">
                {{range  . }}
                <div class="row">

                    <div class="col-md-auto">

                        <ul class="list-group  list-group-flush">
                            <li class="list-group-item" id="{{.Id}}">Порт: {{.Port}} </li>
                        </ul>
                    </div>
                    <div class="col-md-auto">
                        <button id="btn_delete" name="{{.Id}}"
                                class="btn btn-outline-success float-right delete-button">удалить
                        </button>
                    </div>


                </div>
                {{end}}
            </div>
            <div class="col">
                <form id="addserver_form" action="" method="POST">
                    <div class="form-group">
                        <li class="list-group-item" style="border: 0px;">Порт</li>
                        <input class="form-control" type="text" name="port" placeholder="Порт">
                    </div>
                    <button id="addserver" class="btn btn-outline-success float-right">Добавить новый сервер
                    </button>

                </form>
            </div>
        </div>
    </div>

    </body>
    </html>

{{end}}