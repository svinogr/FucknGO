{{ define "main"}}
{{ template "header" .}}

<script> $(document).ready(function () {
        $("#registration").click(function () {
            var form = $("#registration_form").serializeArray();
            var data = new Map();
            $(form).each(function (index, obj) {
                data.set(obj.name, obj.value);
            });

            $.ajax({
                'url': '/api/user',
                'method': 'POST',
                'dataType': 'json',
                'contentType': 'application/json',
                'data': JSON.stringify({
                    "name": data.get('name'),
                    "password": data.get('password'),
                    "email": data.get('email')
                }),
                success: function (response) { //Данные отправлены успешно
                    result = JSON.stringify(response);
                    alert("rr" + result);
                    window.location.href = "/api/mainpage";
                },
                error: function (response) { // Данные не отправлены
                    //   alert("что за говно ты написал в форму?!?");
                    //   result = $.parseJSON(response);
                    alert("error");
                }
            });
        });
    });
</script>
<script src="/static/bootstrap/js/bootstrap.min.js"></script>

<div class="container" style="margin-top:50px;" >
    <div class="row">
        <div class="col">
            <ul class="list-group list-group-flush">
                {{range . }}
                    <li class="list-group-item">Пользователь: {{.Email}} <br> Хэш: {{.Password}}</li>
                {{end}}
            </ul>
        </div>
        <div class="col">
            <div class="container">
            <form id="registration_form" action="" method="POST">
                <p>name</p><input class="form-control me-2" type="text" name="name">
                <p>password</p><input class="form-control me-2" type="text" name="password">
                <p>email</p><input class="form-control me-2" type="email" name="email"><br>
                <button id="registration" class="btn btn-outline-success float-right">Добавить нового юзера</button>
            </form>
            </div>
        </div>

    </div>
</div>

</body>
</html>

{{end}}